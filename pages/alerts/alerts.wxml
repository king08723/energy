<view class="container">
  <!-- 页面标题 -->
  <view class="page-header">
    <view class="page-title">告警消息</view>
    <view class="page-subtitle">实时监控设备状态</view>
  </view>

  <!-- 筛选器 -->
  <view class="filter-section">
    <view class="filter-tabs">
      <view class="filter-tab {{activeTab === 'all' ? 'active' : ''}}" bindtap="switchTab" data-tab="all">
        <text class="tab-text">全部</text>
        <text class="tab-count">{{totalCount}}</text>
      </view>
      <view class="filter-tab {{activeTab === 'unread' ? 'active' : ''}}" bindtap="switchTab" data-tab="unread">
        <text class="tab-text">未读</text>
        <text class="tab-count">{{unreadCount}}</text>
      </view>
      <view class="filter-tab {{activeTab === 'critical' ? 'active' : ''}}" bindtap="switchTab" data-tab="critical">
        <text class="tab-text">严重</text>
        <text class="tab-count">{{criticalCount}}</text>
      </view>
    </view>
    
    <view class="filter-actions">
      <view class="action-btn" bindtap="markAllRead">
        <text class="iconfont icon-check"></text>
        <text>全部已读</text>
      </view>
      <view class="action-btn" bindtap="refreshAlerts">
        <text class="iconfont icon-refresh {{isRefreshing ? 'rotating' : ''}}"></text>
        <text>刷新</text>
      </view>
    </view>
  </view>

  <!-- 告警列表 -->
  <view class="alerts-list">
    <view wx:for="{{filteredAlerts}}" wx:key="id" class="alert-item {{item.isRead ? 'read' : 'unread'}} {{item.level}}" bindtap="viewAlertDetail" data-id="{{item.id}}">
      <!-- 告警状态指示器 -->
      <view class="alert-indicator">
        <view class="status-dot {{item.level}}"></view>
        <view wx:if="{{!item.isRead}}" class="unread-badge"></view>
      </view>
      
      <!-- 告警主要信息 -->
      <view class="alert-main">
        <view class="alert-header">
          <view class="alert-title">{{item.title}}</view>
          <view class="alert-time">{{item.timeAgo}}</view>
        </view>
        
        <view class="alert-content">
          <view class="alert-device">
            <text class="iconfont icon-device"></text>
            <text class="device-name">{{item.deviceName}}</text>
            <text class="device-location">{{item.location}}</text>
          </view>
          
          <view class="alert-description">{{item.description}}</view>
          
          <view class="alert-meta">
            <view class="alert-level">
              <text class="level-icon iconfont {{item.levelIcon}}"></text>
              <text class="level-text">{{item.levelText}}</text>
            </view>
            <view class="alert-type">{{item.type}}</view>
          </view>
        </view>
      </view>
      
      <!-- 快速操作 -->
      <view class="alert-actions">
        <view class="action-item" bindtap="markAsRead" data-id="{{item.id}}" catchtap="true">
          <text class="iconfont icon-check"></text>
        </view>
        <view class="action-item" bindtap="ignoreAlert" data-id="{{item.id}}" catchtap="true">
          <text class="iconfont icon-close"></text>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view wx:if="{{filteredAlerts.length === 0}}" class="empty-state">
      <view class="empty-icon">
        <text class="iconfont icon-bell-off"></text>
      </view>
      <view class="empty-title">暂无告警消息</view>
      <view class="empty-subtitle">系统运行正常</view>
    </view>
  </view>
  
  <!-- 加载更多 -->
  <view wx:if="{{hasMore}}" class="load-more" bindtap="loadMore">
    <view wx:if="{{isLoading}}" class="loading">
      <view class="loading-spinner"></view>
      <text>加载中...</text>
    </view>
    <text wx:else>加载更多</text>
  </view>
</view>