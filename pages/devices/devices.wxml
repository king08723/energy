<!--pages/devices/devices.wxml-->
<view class="energy-container">
  <!-- èƒŒæ™¯è£…é¥° -->
  <view class="energy-bg-decoration">
    <view class="energy-bg-circle" style="width: 200rpx; height: 200rpx; top: 10%; right: -50rpx; animation-delay: 0s; opacity: 0.6;"></view>
    <view class="energy-bg-circle" style="width: 150rpx; height: 150rpx; top: 60%; left: -30rpx; animation-delay: 2s; opacity: 0.4;"></view>
    <view class="energy-bg-circle" style="width: 100rpx; height: 100rpx; top: 80%; right: 20%; animation-delay: 4s; opacity: 0.3;"></view>
  </view>

  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="energy-glass-card energy-p-32">
    <view class="energy-flex energy-flex-between energy-mb-24">
      <text class="energy-title-large">è®¾å¤‡ç®¡ç†</text>
      <view class="energy-flex">
        <!-- å®æ—¶åˆ·æ–°æŒ‡ç¤ºå™¨ -->
        <view class="refresh-indicator {{isRefreshing ? 'active' : ''}}" bindtap="onRefresh">
          <text class="energy-icon-text">ğŸ”„</text>
        </view>
        <view class="energy-icon energy-mr-16" bindtap="onSearch">
          <text class="energy-icon-text">ğŸ”</text>
        </view>
        <view class="energy-icon energy-mr-16" bindtap="onFilter">
          <text class="energy-icon-text">âš™ï¸</text>
        </view>
        <!-- æ‰¹é‡æ“ä½œæŒ‰é’® -->
        <view class="energy-icon" bindtap="onBatchMode">
          <text class="energy-icon-text">{{batchMode ? 'âœ…' : 'â˜‘ï¸'}}</text>
        </view>
      </view>
    </view>
    
    <!-- è®¾å¤‡ç»Ÿè®¡ -->
    <view class="energy-grid-4 energy-mb-24">
      <view class="energy-data-card" 
           role="button" 
           aria-label="æ€»è®¾å¤‡æ•°é‡ï¼š{{deviceStats.total}}å°"
           bindtap="onCardTap" 
           data-type="total">
        <!-- æ€»è®¾å¤‡å›¾æ ‡ -->
        <view class="card-icon">
          <text class="energy-icon-text">ğŸ“±</text>
        </view>
        <text class="energy-text-tertiary energy-text-small">æ€»è®¾å¤‡</text>
        <view class="number-with-trend">
          <text class="energy-title-medium energy-text-primary">{{deviceStats.total}}</text>
          <view class="trend-indicator" wx:if="{{deviceStats.totalTrend}}">
            <text class="trend-arrow {{deviceStats.totalTrend.type}}">{{deviceStats.totalTrend.icon}}</text>
            <text class="trend-text">{{deviceStats.totalTrend.text}}</text>
          </view>
        </view>
        <!-- è®¾å¤‡ç±»å‹åˆ†å¸ƒæŒ‡ç¤ºå™¨ -->
        <view class="device-type-indicator">
          <view class="device-type-dot {{deviceStats.sensorDevices > 0 ? 'active' : ''}}" style="background: #4CAF50;"></view>
          <view class="device-type-dot {{deviceStats.controlDevices > 0 ? 'active' : ''}}" style="background: #2196F3;"></view>
          <view class="device-type-dot {{deviceStats.monitorDevices > 0 ? 'active' : ''}}" style="background: #FF9800;"></view>
          <view class="device-type-dot {{deviceStats.otherDevices > 0 ? 'active' : ''}}" style="background: #9E9E9E;"></view>
        </view>
      </view>
      <view class="energy-data-card" 
           role="button" 
           aria-label="åœ¨çº¿è®¾å¤‡ï¼š{{deviceStats.online}}å°"
           bindtap="onCardTap" 
           data-type="online">
        <!-- åœ¨çº¿è®¾å¤‡å›¾æ ‡ -->
        <view class="card-icon">
          <text class="energy-icon-text">ğŸŸ¢</text>
        </view>
        <text class="energy-text-tertiary energy-text-small">åœ¨çº¿</text>
        <view class="number-with-trend">
          <text class="energy-title-medium energy-text-success">{{deviceStats.online}}</text>
          <view class="trend-indicator" wx:if="{{deviceStats.onlineTrend}}">
            <text class="trend-arrow {{deviceStats.onlineTrend.type}}">{{deviceStats.onlineTrend.icon}}</text>
            <text class="trend-text">{{deviceStats.onlineTrend.text}}</text>
          </view>
        </view>
        <view class="signal-strength">
          <view class="signal-bar {{deviceStats.signalStrength >= 1 ? 'active' : ''}}"></view>
          <view class="signal-bar {{deviceStats.signalStrength >= 2 ? 'active' : ''}}"></view>
          <view class="signal-bar {{deviceStats.signalStrength >= 3 ? 'active' : ''}}"></view>
          <view class="signal-bar {{deviceStats.signalStrength >= 4 ? 'active' : ''}}"></view>
        </view>
      </view>
      <view class="energy-data-card" 
           role="button" 
           aria-label="å‘Šè­¦æ•°é‡ï¼š{{deviceStats.alerts}}ä¸ª"
           bindtap="onCardTap" 
           data-type="alerts">
        <!-- å‘Šè­¦å›¾æ ‡ -->
        <view class="card-icon">
          <text class="energy-icon-text">âš ï¸</text>
        </view>
        <text class="energy-text-tertiary energy-text-small">å‘Šè­¦</text>
        <view class="number-with-trend">
          <text class="energy-title-medium energy-text-warning">{{deviceStats.alerts}}</text>
          <view class="trend-indicator" wx:if="{{deviceStats.alertTrend}}">
            <text class="trend-arrow {{deviceStats.alertTrend.type}}">{{deviceStats.alertTrend.icon}}</text>
            <text class="trend-text">{{deviceStats.alertTrend.text}}</text>
          </view>
        </view>
        <!-- å‘Šè­¦ä¸¥é‡ç¨‹åº¦æŒ‡ç¤ºå™¨ -->
        <view class="alert-severity-indicator">
          <view class="severity-level critical {{deviceStats.criticalAlerts > 0 ? 'active' : ''}}"></view>
          <view class="severity-level warning {{deviceStats.warningAlerts > 0 ? 'active' : ''}}"></view>
          <view class="severity-level info {{deviceStats.infoAlerts > 0 ? 'active' : ''}}"></view>
        </view>
      </view>
      <view class="energy-data-card {{deviceStats.healthScore < 70 ? 'warning' : ''}}" 
           role="button" 
           aria-label="ç³»ç»Ÿå¥åº·åº¦ï¼š{{deviceStats.healthScore}}%"
           bindtap="onCardTap" 
           data-type="health">
        <!-- å¥åº·åº¦å›¾æ ‡ -->
        <view class="card-icon">
          <text class="energy-icon-text">ğŸ’š</text>
        </view>
        <text class="energy-text-tertiary energy-text-small">å¥åº·åº¦</text>
        <view class="number-with-trend">
          <text class="energy-title-medium energy-text-{{deviceStats.healthLevel}}">{{deviceStats.healthScore}}%</text>
          <view class="trend-indicator" wx:if="{{deviceStats.healthTrend}}">
            <text class="trend-arrow {{deviceStats.healthTrend.type}}">{{deviceStats.healthTrend.icon}}</text>
            <text class="trend-text">{{deviceStats.healthTrend.text}}</text>
          </view>
        </view>
        <view class="health-indicator">
          <view class="health-bar" style="width: {{deviceStats.healthScore}}%; background: {{deviceStats.healthColor}};"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ‰¹é‡æ“ä½œå·¥å…·æ  -->
  <view class="batch-toolbar energy-glass-card energy-p-24" wx:if="{{batchMode}}">
    <view class="energy-flex energy-flex-between energy-mb-16">
      <text class="energy-text-primary energy-text-medium">å·²é€‰æ‹© {{selectedDevices.length}} ä¸ªè®¾å¤‡</text>
      <view class="energy-flex">
        <view class="energy-btn energy-btn-outline energy-btn-small energy-mr-8" bindtap="onSelectAll">
          <text>{{selectAllText}}</text>
        </view>
        <view class="energy-btn energy-btn-outline energy-btn-small" bindtap="onCancelBatch">
          <text>å–æ¶ˆ</text>
        </view>
      </view>
    </view>
    <view class="energy-flex energy-flex-wrap">
      <view class="energy-btn energy-btn-primary energy-btn-small energy-mr-8 energy-mb-8" 
            bindtap="onBatchControl" data-action="start">
        <text>æ‰¹é‡å¯åŠ¨</text>
      </view>
      <view class="energy-btn energy-btn-secondary energy-btn-small energy-mr-8 energy-mb-8" 
            bindtap="onBatchControl" data-action="stop">
        <text>æ‰¹é‡åœæ­¢</text>
      </view>
      <view class="energy-btn energy-btn-outline energy-btn-small energy-mr-8 energy-mb-8" 
            bindtap="onBatchControl" data-action="restart">
        <text>æ‰¹é‡é‡å¯</text>
      </view>
      <view class="energy-btn energy-btn-warning energy-btn-small energy-mb-8" 
            bindtap="onBatchDelete">
        <text>æ‰¹é‡åˆ é™¤</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="energy-glass-card energy-p-24" wx:if="{{showSearch}}">
    <view class="energy-flex energy-mb-16">
      <view class="search-input-wrapper energy-flex-1 energy-mr-16">
        <input class="search-input" 
               placeholder="æœç´¢è®¾å¤‡åç§°ã€ç±»å‹æˆ–ä½ç½®" 
               value="{{searchKeyword}}"
               bindinput="onSearchInput"
               confirm-type="search"
               bindconfirm="onSearchConfirm" />
        <view class="search-icon" wx:if="{{!searchKeyword}}">
          <text class="energy-icon-text">ğŸ”</text>
        </view>
        <view class="clear-icon" wx:if="{{searchKeyword}}" bindtap="onClearSearch">
          <text class="energy-icon-text">âœ•</text>
        </view>
      </view>
      <view class="energy-btn energy-btn-primary" bindtap="onSearchConfirm">
        <text>æœç´¢</text>
      </view>
    </view>
    
    <!-- è®¾å¤‡ç±»å‹ç­›é€‰ -->
    <view class="energy-flex energy-flex-wrap energy-mb-16">
      <view class="energy-filter-tag {{filterType === 'all' ? 'active' : ''}}" 
            data-type="all" bindtap="onFilterType">
        <text>å…¨éƒ¨</text>
      </view>
      <view class="energy-filter-tag {{filterType === 'meter' ? 'active' : ''}}"
            data-type="meter" bindtap="onFilterType">
        <text>è®¡é‡è®¾å¤‡</text>
      </view>
      <view class="energy-filter-tag {{filterType === 'sensor' ? 'active' : ''}}"
            data-type="sensor" bindtap="onFilterType">
        <text>ä¼ æ„Ÿå™¨</text>
      </view>
      <view class="energy-filter-tag {{filterType === 'electrical' ? 'active' : ''}}"
            data-type="electrical" bindtap="onFilterType">
        <text>ç”µæ°”è®¾å¤‡</text>
      </view>
      <view class="energy-filter-tag {{filterType === 'hvac' ? 'active' : ''}}"
            data-type="hvac" bindtap="onFilterType">
        <text>ç©ºè°ƒè®¾å¤‡</text>
      </view>
      <view class="energy-filter-tag {{filterType === 'heating' ? 'active' : ''}}"
            data-type="heating" bindtap="onFilterType">
        <text>åŠ çƒ­è®¾å¤‡</text>
      </view>
      <view class="energy-filter-tag {{filterType === 'water' ? 'active' : ''}}"
            data-type="water" bindtap="onFilterType">
        <text>æ°´å¤„ç†</text>
      </view>
    </view>
    
    <!-- è®¾å¤‡çŠ¶æ€ç­›é€‰ - æ–°å¢åŠŸèƒ½ -->
    <view class="filter-section-title">
      <text class="energy-text-small energy-text-tertiary">è®¾å¤‡çŠ¶æ€</text>
    </view>
    <!-- æ¨ªå‘æ»šåŠ¨çš„çŠ¶æ€ç­›é€‰æ ‡ç­¾ -->
    <scroll-view class="status-filter-scroll" scroll-x="true" show-scrollbar="false">
      <view class="status-filter-container">
        <view class="energy-filter-tag status-filter {{filterType === 'offline' ? 'active' : ''}}" 
              data-type="offline" bindtap="onFilterType">
          <text class="energy-icon-text">ğŸ”´</text>
          <text>ç¦»çº¿è®¾å¤‡</text>
        </view>
        <view class="energy-filter-tag status-filter {{filterType === 'alert' ? 'active' : ''}}" 
              data-type="alert" bindtap="onFilterType">
          <text class="energy-icon-text">âš ï¸</text>
          <text>å‘Šè­¦è®¾å¤‡</text>
        </view>
        <view class="energy-filter-tag status-filter {{filterType === 'abnormal' ? 'active' : ''}}" 
              data-type="abnormal" bindtap="onFilterType">
          <text class="energy-icon-text">âš¡</text>
          <text>å¼‚å¸¸è®¾å¤‡</text>
        </view>
        <view class="energy-filter-tag status-filter {{filterType === 'healthy' ? 'active' : ''}}" 
              data-type="healthy" bindtap="onFilterType">
          <text class="energy-icon-text">âœ…</text>
          <text>æ­£å¸¸è®¾å¤‡</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è®¾å¤‡åˆ†ç»„ -->
  <view class="energy-glass-card energy-p-24" wx:if="{{showGroups}}">
    <view class="energy-flex energy-flex-between energy-mb-16">
      <text class="energy-title-medium">è®¾å¤‡åˆ†ç»„</text>
      <view class="energy-btn energy-btn-outline" bindtap="onManageGroups">
        <text>ç®¡ç†åˆ†ç»„</text>
      </view>
    </view>
    <scroll-view class="energy-group-scroll" scroll-x="true">
      <view class="energy-flex">
        <view class="energy-group-item {{selectedGroup === 'all' ? 'active' : ''}}" 
              data-group="all" bindtap="onSelectGroup">
          <text>å…¨éƒ¨è®¾å¤‡</text>
        </view>
        <view class="energy-group-item {{selectedGroup === item.id ? 'active' : ''}}" 
              wx:for="{{deviceGroups}}" wx:key="id"
              data-group="{{item.id}}" bindtap="onSelectGroup">
          <text>{{item.name}}</text>
          <text class="energy-text-small energy-text-tertiary">({{item.count}})</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è®¾å¤‡åˆ—è¡¨ -->
  <view class="energy-glass-card energy-p-24">
    <view class="energy-flex energy-flex-between energy-mb-24">
      <view class="device-list-header">
        <text class="energy-title-medium">è®¾å¤‡åˆ—è¡¨</text>
        <!-- ç­›é€‰ç»“æœç»Ÿè®¡ä¿¡æ¯ -->
        <view class="filter-result-info" wx:if="{{filterType !== 'all' || searchKeyword || selectedGroup !== 'all'}}">
          <text class="energy-text-small energy-text-tertiary">ç­›é€‰ç»“æœï¼š{{devices.length}} ä¸ªè®¾å¤‡</text>
          <view class="energy-btn energy-btn-outline energy-btn-small energy-ml-8" bindtap="onClearFilter">
            <text>æ¸…é™¤ç­›é€‰</text>
          </view>
        </view>
      </view>
      <view class="energy-btn energy-btn-primary" bindtap="onAddDevice">
        <text class="energy-icon-text energy-mr-8">â•</text>
        <text>æ·»åŠ è®¾å¤‡</text>
      </view>
    </view>

    <!-- è®¾å¤‡åˆ—è¡¨æ»šåŠ¨å®¹å™¨ -->
    <scroll-view class="device-scroll-container" 
                 scroll-y="true" 
                 scroll-top="{{scrollTop}}"
                 bindscrolltolower="onLoadMore"
                 lower-threshold="50">
      <!-- è®¾å¤‡é¡¹ - ä¼˜åŒ–åçš„å¡ç‰‡å¼å¸ƒå±€ -->
      <view class="device-list">
        <view class="device-card {{batchMode ? 'batch-mode' : ''}} {{item.isSelected ? 'selected' : ''}}"
              wx:for="{{currentPageDevices}}" wx:key="id"
              bindtap="{{batchMode ? 'onSelectDevice' : 'onDeviceDetail'}}"
              data-device="{{item}}" data-device-id="{{item.id}}">
        
        <!-- æ‰¹é‡é€‰æ‹©å¤é€‰æ¡† -->
        <view class="batch-checkbox" wx:if="{{batchMode}}">
          <view class="checkbox {{item.isSelected ? 'checked' : ''}}">
            <text class="energy-icon-text" wx:if="{{item.isSelected}}">âœ“</text>
          </view>
        </view>
        
        <!-- è®¾å¤‡å¡ç‰‡ä¸»ä½“ -->
        <view class="device-card-content">
          <!-- è®¾å¤‡æ ‡é¢˜è¡Œ - ç‹¬ç«‹æ˜¾ç¤º -->
          <view class="device-title-row">
            <!-- è®¾å¤‡å›¾æ ‡ä½œä¸ºæ ‡é¢˜è¡Œçš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ -->
            <view class="device-icon {{item.type}}">
              <text class="energy-icon-text">{{item.icon}}</text>
              <!-- è®¾å¤‡å¥åº·çŠ¶æ€æŒ‡ç¤ºå™¨ -->
              <view class="health-indicator-dot {{item.healthStatus || 'good'}}"></view>
            </view>
            <text class="device-name">{{item.name}}</text>
            <view class="device-status-badge {{item.status}}">
              <view class="status-dot"></view>
              <text class="status-text">{{item.statusText}}</text>
              <!-- å®æ—¶æ•°æ®æ›´æ–°æŒ‡ç¤ºå™¨ -->
              <view class="data-update-indicator {{item.isUpdating ? 'active' : ''}}" wx:if="{{item.status === 'online'}}">
                <text class="energy-icon-text">ğŸ“¡</text>
              </view>
            </view>
          </view>
          
          <!-- è®¾å¤‡å¤´éƒ¨ä¿¡æ¯ -->
          <view class="device-header">
            <!-- è®¾å¤‡åŸºç¡€ä¿¡æ¯ -->
            <view class="device-primary-info">
              <view class="device-basic-info">
                <!-- è®¾å¤‡ç±»å‹å’Œä½ç½® -->
                <view class="device-meta-row">
                  <view class="device-type-tag {{item.type}}">
                    <text>{{item.type}}</text>
                  </view>
                  <text class="device-location">{{item.location}}</text>
                </view>
              </view>
            </view>
            
            <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
            <view class="device-actions" wx:if="{{!batchMode}}" catchtap="true">
              <view class="action-btn control-btn {{item.status !== 'online' ? 'disabled' : ''}}" 
                    bindtap="onDeviceControl" data-device="{{item}}">
                <text class="energy-icon-text">{{item.status === 'online' ? 'â¸ï¸' : 'â–¶ï¸'}}</text>
              </view>
              <view class="action-btn menu-btn" bindtap="onDeviceMenu" data-device="{{item}}">
                <text class="energy-icon-text">â‹¯</text>
              </view>
            </view>
          </view>
          
          
        </view>
      </view>
      </view>
      
      <!-- åŠ è½½æ›´å¤šæç¤ºï¼ˆä»…åœ¨ä¸æ˜¾ç¤ºåˆ†é¡µæ—¶æ˜¾ç¤ºï¼‰ -->
      <view class="load-more-container" wx:if="{{currentPageDevices.length > 0 && !showPagination}}">
        <view class="load-more-item" wx:if="{{loadingMore}}">
          <view class="loading-spinner"></view>
          <text class="energy-text-tertiary energy-text-small">æ­£åœ¨åŠ è½½æ›´å¤š...</text>
        </view>
        <view class="load-more-item" wx:elif="{{!hasMore}}">
          <text class="energy-text-tertiary energy-text-small">å·²æ˜¾ç¤ºå…¨éƒ¨è®¾å¤‡</text>
        </view>
      </view>
    </scroll-view>

    <!-- é¡µç å¯¼èˆª -->
    <view class="pagination-container" wx:if="{{showPagination && currentPageDevices.length > 0}}">
      <view class="pagination-info">
        <text class="energy-text-tertiary energy-text-small">ç¬¬ {{currentPage}} é¡µï¼Œå…± {{totalPages}} é¡µ</text>
      </view>
      <view class="pagination-controls">
        <!-- ä¸Šä¸€é¡µæŒ‰é’® -->
        <view class="pagination-btn {{currentPage <= 1 ? 'disabled' : ''}}" 
              bindtap="onPrevPage">
          <text class="energy-icon-text">â€¹</text>
        </view>
        
        <!-- é¡µç æŒ‰é’® -->
        <view class="pagination-pages">
          <block wx:for="{{totalPages}}" wx:key="*this">
            <view class="pagination-page {{currentPage === (index + 1) ? 'active' : ''}}" 
                  bindtap="onGoToPage" 
                  data-page="{{index + 1}}">
              <text>{{index + 1}}</text>
            </view>
          </block>
        </view>
        
        <!-- ä¸‹ä¸€é¡µæŒ‰é’® -->
        <view class="pagination-btn {{currentPage >= totalPages ? 'disabled' : ''}}" 
              bindtap="onNextPage">
          <text class="energy-icon-text">â€º</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="energy-empty-state" wx:if="{{currentPageDevices.length === 0 && devices.length === 0}}">
      <text class="energy-icon-text energy-text-large energy-mb-16">ğŸ“±</text>
      <text class="energy-text-primary energy-text-medium energy-mb-8">æš‚æ— è®¾å¤‡</text>
      <text class="energy-text-tertiary energy-text-small energy-mb-24">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªè®¾å¤‡</text>
      <view class="energy-btn energy-btn-primary" bindtap="onAddDevice">
        <text class="energy-icon-text energy-mr-8">â•</text>
        <text>æ·»åŠ è®¾å¤‡</text>
      </view>
    </view>
  </view>

  <!-- è®¾å¤‡æ€§èƒ½ç›‘æ§ -->
  <view class="energy-glass-card energy-p-24">
    <view class="energy-flex energy-flex-between energy-mb-16">
      <text class="energy-title-medium">è®¾å¤‡æ€§èƒ½</text>
      <view class="energy-btn energy-btn-outline energy-btn-small" bindtap="onViewPerformance">
        <text>æŸ¥çœ‹è¯¦æƒ…</text>
      </view>
    </view>
    <view class="performance-grid">
      <!-- å¹³å‡å“åº”æ—¶é—´æ€§èƒ½å¡ç‰‡ -->
      <view class="performance-item performance-item-response">
        <!-- é¡¶éƒ¨æŒ‡æ ‡æ ‡é¢˜å’Œè¶‹åŠ¿ -->
        <view class="metric-header">
          <view class="metric-icon">
            <text class="energy-icon-text">âš¡ï¸</text>
          </view>
          <text class="metric-label">å¹³å‡å“åº”æ—¶é—´</text>
          <view class="trend-indicator {{performanceData.responseTimeTrend}}">
            <text class="trend-icon">{{performanceData.responseTimeTrend === 'up' ? 'ğŸ“ˆ' : 'ğŸ“‰'}}</text>
          </view>
        </view>
        
        <!-- ä¸»è¦æ•°å€¼æ˜¾ç¤º -->
        <view class="metric-value">
          <text class="value-number">{{performanceData.avgResponseTime}}</text>
          <text class="value-unit">ms</text>
        </view>
        
        <!-- åº•éƒ¨æ€§èƒ½æŒ‡ç¤ºå™¨ -->
        <view class="metric-indicator">
          <view class="performance-bar" style="width: {{performanceData.responseScore}}%;"></view>
        </view>
      </view>
      
      <!-- æ•°æ®ä¼ è¾“æˆåŠŸç‡æ€§èƒ½å¡ç‰‡ -->
      <view class="performance-item performance-item-success">
        <!-- é¡¶éƒ¨æŒ‡æ ‡æ ‡é¢˜ -->
        <view class="metric-header">
          <view class="metric-icon">
            <text class="energy-icon-text">ğŸ¯</text>
          </view>
          <text class="metric-label">ä¼ è¾“æˆåŠŸç‡</text>
          <view class="trend-indicator {{performanceData.successTrend}}">
            <text class="trend-icon">{{performanceData.successTrend === 'up' ? 'ğŸ“ˆ' : 'ğŸ“‰'}}</text>
          </view>
        </view>
        
        <!-- ä¸»è¦æ•°å€¼æ˜¾ç¤º -->
        <view class="metric-value">
          <text class="value-number">{{performanceData.successRate}}</text>
          <text class="value-unit">%</text>
        </view>
        
        <!-- åº•éƒ¨æˆåŠŸç‡æŒ‡ç¤ºå™¨ -->
        <view class="metric-indicator">
          <view class="success-rate-bar">
            <view class="rate-fill" style="width: {{performanceData.successRate}}%;"></view>
          </view>
        </view>
      </view>
      
      <!-- ç½‘ç»œå»¶è¿Ÿæ€§èƒ½å¡ç‰‡ -->
      <view class="performance-item performance-item-latency">
        <!-- é¡¶éƒ¨æŒ‡æ ‡æ ‡é¢˜ -->
        <view class="metric-header">
          <view class="metric-icon">
            <text class="energy-icon-text">ğŸ“¡</text>
          </view>
          <text class="metric-label">ç½‘ç»œå»¶è¿Ÿ</text>
          <view class="trend-indicator {{performanceData.latencyTrend}}">
            <text class="trend-icon">{{performanceData.latencyTrend === 'up' ? 'ğŸ“ˆ' : 'ğŸ“‰'}}</text>
          </view>
        </view>
        
        <!-- ä¸»è¦æ•°å€¼æ˜¾ç¤º -->
        <view class="metric-value">
          <text class="value-number">{{performanceData.networkLatency}}</text>
          <text class="value-unit">ms</text>
        </view>
        
        <!-- åº•éƒ¨å»¶è¿ŸçŠ¶æ€æŒ‡ç¤ºå™¨ -->
        <view class="metric-indicator">
          <view class="latency-indicator {{performanceData.latencyLevel}}">
            <view class="latency-dot"></view>
            <view class="latency-pulse"></view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ™ºèƒ½æ¨è -->
  <view class="energy-glass-card energy-p-24" wx:if="{{recommendations.length > 0}}">
    <text class="energy-title-medium energy-mb-16">æ™ºèƒ½æ¨è</text>
    <view class="recommendation-list">
      <view class="recommendation-item" wx:for="{{recommendations}}" wx:key="id">
        <view class="recommendation-icon {{item.type}}">
          <text class="energy-icon-text">{{item.icon}}</text>
        </view>
        <view class="recommendation-content energy-flex-1">
          <text class="energy-text-primary energy-text-medium energy-mb-4">{{item.title}}</text>
          <text class="energy-text-tertiary energy-text-small">{{item.description}}</text>
        </view>
        <view class="energy-btn energy-btn-outline energy-btn-small" 
              bindtap="onApplyRecommendation" data-recommendation="{{item}}">
          <text>åº”ç”¨</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="energy-glass-card energy-p-24">
    <text class="energy-title-medium energy-mb-16">å¿«æ·æ“ä½œ</text>
    <view class="energy-grid-2">
      <view class="energy-action-card" data-type="scene" bindtap="onSceneMode">
         <view class="icon">ğŸ­</view>
         <view class="title">åœºæ™¯æ¨¡å¼</view>
         <view class="description">ä¸€é”®åˆ‡æ¢è®¾å¤‡åœºæ™¯</view>
       </view>
       <view class="energy-action-card" data-type="automation" bindtap="onAutomation">
         <view class="icon">ğŸ¤–</view>
         <view class="title">è‡ªåŠ¨åŒ–</view>
         <view class="description">è®¾ç½®è‡ªåŠ¨åŒ–è§„åˆ™</view>
       </view>
       <view class="energy-action-card" data-type="maintenance" bindtap="onDeviceMaintenance">
         <view class="icon">ğŸ”§</view>
         <view class="title">è®¾å¤‡ç»´æŠ¤</view>
         <view class="description">æŸ¥çœ‹ç»´æŠ¤è®¡åˆ’</view>
       </view>
       <view class="energy-action-card" data-type="analysis" bindtap="onEnergyAnalysis">
          <view class="icon">ğŸ“Š</view>
          <view class="title">èƒ½è€—åˆ†æ</view>
          <view class="description">è®¾å¤‡èƒ½è€—æŠ¥å‘Š</view>
        </view>
    </view>
  </view>
  <custom-footer></custom-footer>
</view>